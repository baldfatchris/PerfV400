@model IEnumerable<PerfV400.Models.Performance>

@{
    int nextPage = 1;
    if (ViewBag.page != null)
    {
        nextPage = ViewBag.page +1 ;
    }
    string nextDiv = string.Format("more{0}", nextPage);
}


@foreach (var item in Model)
{
<div class="Photo150">
    <div class="PhotoImage">
        <a href="@Url.Action("Details", "Event", new { id = item.Event.Event_Id }, null)">
            <img class="thumb" width="150" src="@Url.Action("GetPerformanceImage", "Piece", new { id = item.Performance_Id })" alt="" border="0" style="border:0"/>
        </a>
    </div>
    <div class="UserStatus">
    </div>
    <div class="PhotoCaption">
        <div class="PhotoCaptionText">
            <a href="@Url.Action("Details", "Event", new { id = item.Event.Event_Id }, null)">
                <strong>@Html.DisplayFor(modelItem => item.Event.Event_Name)</strong> - 
                @(item.Event.Event_Date.ToLongDateString()) - 
                @Html.DisplayFor(modelItem => item.Event.Venue.Venue_Name) - 
                @Html.DisplayFor(modelItem => item.Event.Venue.Venue_City)
            </a>
        </div>
    </div>
</div>        
 
}


@if (ViewBag.recordCount - 60 * ViewBag.page > 60)
{
<div id="@nextDiv">

    @Ajax.ActionLink("more...", "MoreVenuePerformances",
        new
        {
            filter_Venue_Id = ViewBag.Venue_Id,
            filter_search = HttpUtility.UrlEncode((string)ViewBag.filter_search),
            filter_Performance_GenreId = ViewBag.filter_Performance_GenreId,
            filter_Performance_Piece = ViewBag.filter_Performance_Piece,
            filter_From_Performance_Date = ViewBag.filter_From_Performance_Date,
            filter_To_Performance_Date = ViewBag.filter_To_Performance_Date,
            page = nextPage
        },
        new AjaxOptions
        {
            UpdateTargetId = nextDiv,
            InsertionMode = InsertionMode.Replace,
            HttpMethod = "GET",
            LoadingElementId = "ajax-loader1"
        })
    <div style="clear:both"></div>

    <img id="ajax-loader1" alt="loading" src="@Url.Content("~/Content/loading_lg.gif")" style="display:none" />

</div>
}


